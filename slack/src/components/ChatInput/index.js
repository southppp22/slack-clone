import React, { useState } from "react";
import * as S from "./style";
import { Button } from "@material-ui/core";
import { db } from "../../firebase";
import firebase from "firebase";

function ChatInput({ channelName, channelId, chatRef }) {
  const [input, setInput] = useState("");

  const sendMessage = (e) => {
    e.preventDefault(); // prevents refresh

    if (!channelId || input === "") {
      return false;
    }

    db.collection("rooms").doc(channelId).collection("messages").add({
      message: input,
      timestamp: firebase.firestore.FieldValue.serverTimestamp(),
      user: "NamIn",
      userimage:
        "data:image/jpeg;base64,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",
    });

    chatRef?.current?.scrollIntoView({
      behavior: "smooth",
    });

    setInput("");
  };

  return (
    <S.ChatInputContainer>
      <form>
        <input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder={`Message #${channelName}`}
        />
        <Button hidden type="submit" onClick={sendMessage} />
      </form>
    </S.ChatInputContainer>
  );
}

export default ChatInput;
